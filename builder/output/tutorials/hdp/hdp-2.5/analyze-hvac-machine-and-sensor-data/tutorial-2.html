<div class="tutorial-content">
  <h1 id="analyze-hvac-machine-and-sensor-data">Analyze HVAC Machine and Sensor Data</h1>

<h2 id="lab-2---visualize-hvac-data-via-zeppelin">Lab 2 - Visualize HVAC Data Via Zeppelin</h2>

<h2 id="introduction">Introduction</h2>

<p>You will learn to gain more insights on your data by visualizing certain key attributes using Apache Zeppelin. You will to learn to visualize a graph that shows the countries that have the most extreme temperature and the amount of <strong>NORMAL</strong> events there are compared to <strong>HOT</strong> and <strong>COLD</strong>. You will also learn to see which HVAC units result in the most <code class="highlighter-rouge">extremetemp</code> readings.</p>

<h2 id="prerequisites">Prerequisites</h2>

<ul>
  <li>Lab 1 - Upload and Refine Data with Hive</li>
</ul>

<h2 id="outline">Outline</h2>

<ul>
  <li><a href="#apache-zeppelin-lab2">Apache Zeppelin</a></li>
  <li><a href="#visualize-temp-ranges-countries">Step 1: Visualize Temperature Ranges of Countries</a></li>
  <li><a href="#dtrm-buildings-hvac-upgrades">Step 2: Determine Which Buildings Need HVAC Upgrades</a></li>
  <li><a href="#summary-lab2">Summary</a></li>
  <li><a href="#further-reading-lab2">Further Reading</a></li>
</ul>

<h2 id="apache-zeppelin-">Apache Zeppelin <a id="apache-zeppelin-lab2"></a></h2>

<p>Apache Zeppelin is data reporting tool on Hadoop. Zeppelin integrates with Hadoop by using tools called interpreters. It has direct connections to Apache Spark and Hive in your cluster and allows you to create visualizations and analyze your data on the fly.
Apache Zeppelin gives you the power to connect right to your Hadoop cluster to quickly obtain results from the data inside of Hadoop without having to export data to any other sources.</p>

<p>It’s also important to note that Zeppelin contains several interpreters that can be utilized to obtain data in a variety of ways.
One of the default interpreters included with Zeppelin is for Apache Spark. With the popularity of Apache Spark rising, you can simply write Spark scripts to execute directly on Apache Zeppelin to obtain results from your data in a matter of seconds.</p>

<h2 id="step-1-visualize-temperature-ranges-of-countries-">Step 1: Visualize Temperature Ranges of Countries <a id="visualize-temp-ranges-countries"></a></h2>

<p>1. Access Zeppelin at <a href="http://localhost:9995/">localhost:9995</a></p>

<p>From here we’re going to need to create a new Zeppelin Notebook. Notebooks in Zeppelin is how we differentiate reports from one another.</p>

<p>2. Hover over <strong>Notebook</strong>. Use the dropdown menu and <strong>Create a new note</strong>.</p>

<p><img src="https://raw.githubusercontent.com/orendain/big-data-tutorials/master/tutorials/hdp/hdp-2.5/analyze-hvac-machine-and-sensor-data/assets/lab2-visualize-data-via-zeppelin/zeppelin_dashboard.png" alt="" /></p>

<p>3. Name the note <strong>HVAC Analysis Report</strong> and then <strong>Create Note</strong>.</p>

<p><img src="https://raw.githubusercontent.com/orendain/big-data-tutorials/master/tutorials/hdp/hdp-2.5/analyze-hvac-machine-and-sensor-data/assets/lab2-visualize-data-via-zeppelin/create_zeppelin_notebook.png" alt="" /></p>

<p>We will use the Hive interpreter to run Hive queries and visualize the results in Zeppelin.</p>

<p>4. To access the Hive interpreter for this note, we must insert <code class="highlighter-rouge">%jdbc(hive)</code> at the top of the note. Everything afterwards will be interpreted as a Hive query.</p>

<p><img src="https://raw.githubusercontent.com/orendain/big-data-tutorials/master/tutorials/hdp/hdp-2.5/analyze-hvac-machine-and-sensor-data/assets/lab2-visualize-data-via-zeppelin/zeppelin_hvac_analysis_report_notebook.png" alt="" /></p>

<p>5. Type the following query into the note, then run it by clicking the <strong>Run</strong> arrow or by using the shortcut <strong>Shift+Enter</strong>.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>%jdbc(hive)

select country, extremetemp, temprange from hvac_building
</code></pre>
</div>

<p><img src="https://raw.githubusercontent.com/orendain/big-data-tutorials/master/tutorials/hdp/hdp-2.5/analyze-hvac-machine-and-sensor-data/assets/lab2-visualize-data-via-zeppelin/load_hvac_building_data_zeppelin.png" alt="" /></p>

<p>Now that the query is run, let’s visualize the data with a chart.</p>

<p>6. Select the bar graph chart button located just under the query.</p>

<p>7. Click <strong>settings</strong> to open up more advanced settings for creating the chart.</p>

<p><img src="https://raw.githubusercontent.com/orendain/big-data-tutorials/master/tutorials/hdp/hdp-2.5/analyze-hvac-machine-and-sensor-data/assets/lab2-visualize-data-via-zeppelin/visualize_hvac_buiding_data_bargraph.png" alt="" /></p>

<p>8. Here you will experiment with different values and columns to customize data that is illustrated in your visualization.</p>

<ul>
  <li>Arrange the fields according to the following image.</li>
  <li>Drag the field <code class="highlighter-rouge">temprange</code> into the <strong>groups</strong> box.</li>
  <li>Click <strong>SUM</strong> on <code class="highlighter-rouge">extremetemp</code> and change it to <strong>COUNT</strong>.</li>
  <li>Make sure that <code class="highlighter-rouge">country</code> is the only field under <strong>Keys</strong>.</li>
</ul>

<p><img src="https://raw.githubusercontent.com/orendain/big-data-tutorials/master/tutorials/hdp/hdp-2.5/analyze-hvac-machine-and-sensor-data/assets/lab2-visualize-data-via-zeppelin/customize_bar_graph_settings_hvac_building_zeppelin.png" alt="" /></p>

<p>You’ve just customized your chart’s settings to portray the countries and their temperature from cold, normal to hot using Apache Zeppelin.</p>

<p><img src="https://raw.githubusercontent.com/orendain/big-data-tutorials/master/tutorials/hdp/hdp-2.5/analyze-hvac-machine-and-sensor-data/assets/lab2-visualize-data-via-zeppelin/countries_most_extrm_temp_zeppelin.png" alt="" /></p>

<ul>
  <li>From the chart above we can see which countries have the most extreme temperature and how many <strong>NORMAL</strong> events there are compared to <strong>HOT</strong> and <strong>COLD</strong>.</li>
</ul>

<h2 id="step-2-determine-which-buildings-need-hvac-upgrades-">Step 2: Determine Which Buildings Need HVAC Upgrades <a id="dtrm-buildings-hvac-upgrades"></a></h2>

<p>Is it possible to figure out which buildings might need HVAC upgrades, and which do not? Let’s determine that answer in the steps ahead…</p>

<ul>
  <li>Let’s try creating one more note to visualize which types of HVAC systems result in the least amount of <code class="highlighter-rouge">extremetemp</code> readings.</li>
</ul>

<p>9. Paste the following query into the blank Zeppelin note following the chart we made previously.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>%jdbc(hive)

select hvacproduct, extremetemp from hvac_building
</code></pre>
</div>

<p>10. Use <strong>Shift+Enter</strong> to run the note.</p>

<p><img src="https://raw.githubusercontent.com/orendain/big-data-tutorials/master/tutorials/hdp/hdp-2.5/analyze-hvac-machine-and-sensor-data/assets/lab2-visualize-data-via-zeppelin/load_hvacproduct_extrmtemp_hvacblding_data.png" alt="" /></p>

<p>11. Arrange the fields according to the following image so we can recreate the chart below.</p>

<ul>
  <li>Make sure that <code class="highlighter-rouge">hvacproduct</code> is in the <strong>Keys</strong> box.</li>
  <li>Make sure that <code class="highlighter-rouge">extremetemp</code> is in the <strong>Values</strong> box and that it is set to <strong>COUNT</strong>.</li>
</ul>

<p><img src="https://raw.githubusercontent.com/orendain/big-data-tutorials/master/tutorials/hdp/hdp-2.5/analyze-hvac-machine-and-sensor-data/assets/lab2-visualize-data-via-zeppelin/customize_show_mostextrm_readings_hvac.png" alt="" /></p>

<ul>
  <li>Now we can see which HVAC units result in the most <code class="highlighter-rouge">extremetemp</code> readings. Thus we can make a more informed decision when purchasing new HVAC systems.</li>
</ul>

<h2 id="summary-">Summary <a id="summary-lab2"></a></h2>

<p>We’ve successfully gained more insights on our data by visualizing certain key attributes using Apache Zeppelin. We learned to visualize a graph that shows the countries that have the most extreme temperature and the amount of <strong>NORMAL</strong> events there are compared to <strong>HOT</strong> and <strong>COLD</strong>. We learned to see which HVAC units result in the most <code class="highlighter-rouge">extremetemp</code> readings.</p>

<h2 id="further-reading-">Further Reading <a id="further-reading-lab2"></a></h2>

<ul>
  <li><a href="https://community.hortonworks.com/questions/78430/how-to-create-map-visualization-in-apache-zeppelin.html">How to create Map Visualization in Apache Zeppelin</a></li>
  <li><a href="https://community.hortonworks.com/articles/75834/using-angular-within-apache-zeppelin-to-create-cus.html">Using Angular within Apache Zeppelin to create custom visualizations</a></li>
</ul>

</div>

<hr>

<div id="tutorial-footer">
  <h2>Tutorial Q&amp;A and Reporting Issues</h2>

  <p>If you need help or have questions with this tutorial, please check HCC for answers to existing questions about this tutorial by using the Find Answers button below.  You can post a new HCC question by using the Ask Questions button below.</p>

  <p>
    <a class="btn" href="https://community.hortonworks.com/topics/tutorial-310.html" role="button">Find Answers</a>
    <a class="btn pull-right" href="https://community.hortonworks.com/questions/ask.html?space=81&topics=tutorial-310&amp;topics=hdp-2.5.0" role="button">Ask Questions</a>
  </p>

  <p>Tutorial Name: <strong>Analyze HVAC Machine and Sensor Data</strong></p>
  <p>HCC Tags:<strong> tutorial-310</strong> and <strong>hdp-2.5.0</strong></p>
  <p>If the tutorial has multiple components please indicate which one your question relates to.</p>

  <p>All Hortonworks, partner and community tutorials are posted in the Hortonworks GitHub repository and can be contributed to by following the <a href="https://github.com/hortonworks/big-data-tutorials/wiki">Tutorial Contribution Guide</a>.  For issues/bugs/feedback, please <a href="https://github.com/hortonworks/big-data-tutorials/issues/new">submit an issue</a> and we will do our best to resolve it!</p>
</div>

