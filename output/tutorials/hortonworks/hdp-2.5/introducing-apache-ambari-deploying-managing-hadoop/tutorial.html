<div class="tutorial-content">
  <h2 id="introduction">Introduction</h2>

<p>In this tutorial, we will explore how to quickly and easily deploy Apache Hadoop with <a href="http://hortonworks.com/hadoop/ambari">Apache Ambari</a>. We will spin up our own VM with <a href="http://www.vagrantup.com/">Vagrant</a> and <a href="http://hortonworks.com/hadoop/ambari">Apache Ambari</a>. Vagrant is very popular with developers as it lets one mirror the production environment in a VM while staying with all the IDEs and tools in the comfort of the host OS.</p>

<p>If you’re just looking to get started with Hadoop in a VM, then you can simply download the <a href="http://hortonworks.com/sandbox">Hortonworks Sandbox</a>.</p>

<h2 id="prerequisites">Prerequisites</h2>

<ul>
  <li><a href="https://www.virtualbox.org/wiki/Downloads">VirtualBox</a></li>
  <li><a href="http://vagrantup.com/">Vagrant</a></li>
</ul>

<h2 id="outline">Outline</h2>

<ul>
  <li><a href="#spin-up">1. Spin up a VM with Vagrant</a></li>
  <li><a href="#configure-vm">2. Configure the VM</a></li>
  <li><a href="#passwordless-ssh">3. Setting up Passwordless SSH</a></li>
  <li><a href="#setup-ambari">4. Set up Ambari</a></li>
  <li><a href="#pseudo-mode">5. Pseudo-Mode HDP Cluster Set up using Ambari</a></li>
</ul>

<h3 id="1-spin-up-a-vm-with-vagrant-">1. Spin up a VM with Vagrant <a id="spin-up"></a></h3>

<p>Create a folder for this VM using:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>mkdir hdp_vm
</code></pre>
</div>

<p>Install Virtualbox and Vagrant and then issue the following command:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>vagrant box add hdp_vm https://github.com/2creatives/vagrant-centos/releases/download/v6.5.1/centos65-x86_64-20131205.box
</code></pre>
</div>

<p>It starts the download and gets added to the library of VMs with the name <strong>hdp_vm</strong>. Issue below command now to initialize the vagrant:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>vagrant init hdp_vm
</code></pre>
</div>

<p>This command creates a VagrantFile in the folder. Use vi editor to make changes.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>vi VagrantFile
</code></pre>
</div>

<p>Change the forwarded port to 8080 like this:</p>

<p><img src="assets/change_port.png" alt="change_port" /></p>

<p>Change the memory size to 8 GB,</p>

<p><img src="assets/change_memory.png" alt="change_memory" /></p>

<p>Save the file and launch the VM and SSH in and login as root and change to the home directory. Follow below steps:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>vagrant up
vagrant ssh
sudo su
cd ~
</code></pre>
</div>

<h3 id="2-configure-the-vm-">2. Configure the VM <a id="configure-vm"></a></h3>

<p>Type <code class="highlighter-rouge">hostname</code> on command line to find out the hostname of the machine.</p>

<p><img src="assets/hostname.png" alt="hostname" /></p>

<p>Edit /etc/hosts file to map the IP address with the hostname. The hosts file is used to recognize the mapping of hostnames to the IP addresses of the host. So the Ambari server consults this file to determine the IP address that corresponds to a host name. So in this case, the leftmost column is the IP address to be resolved, the second one is the hostname and the third one is just the alias for the host name.</p>

<p><img src="assets/hosts_file.png" alt="hosts_file" /></p>

<p>Install <strong>ntp</strong> and <strong>wget</strong> utility using following commands:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>yum install ntp
yum install wget
</code></pre>
</div>

<p>NTP(Network Time Protocol) service is required when the computer clocks in servers are set manually, it gets drifted by each passing day if not closely monitored. So to avoid this, it is advisable to enable NTP to synchronize the time of all hosts within the cluster with Ambari server.
Start the <strong>ntpd</strong> service through:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>chkconfig ntpd on
service ntpd start
</code></pre>
</div>

<p><img src="assets/chkconfig.png" alt="chkconfig" /></p>

<h3 id="3-setting-up-passwordless-ssh-">3. Setting up Passwordless SSH <a id="passwordless-ssh"></a></h3>

<p>It is required so that the Ambari server installed on one host can communicate with other hosts within the cluster to install Ambari agents. The server uses the key pair to access other hosts.
Generate the key using ssh-keygen</p>

<p><img src="assets/ssh_keygen.png" alt="ssh_keygen" /></p>

<p>The keys will be placed in the folder <strong>.ssh</strong>.</p>

<p>Copy the <strong>id_rsa</strong> file to /vagrant folder so that you can access the private key from the host machine as /vagrant is automatically the shared folder between host and guest OSs.</p>

<p>Also append id_rsa.pub, the public key to the authorized_keys keys file.</p>

<p><img src="assets/authorized_keys.png" alt="authorized_keys" /></p>

<h3 id="4-set-up-ambari-">4. Set up Ambari <a id="setup-ambari"></a></h3>

<p>Download and copy the ambari repository bits to <strong>/etc/yum/repos.d</strong>:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>wget http://public-repo-1.hortonworks.com/ambari/centos6/2.x/updates/2.2.2.0/ambari.repo
mv ambari.repo /etc/yum.repos.d
yum repolist
</code></pre>
</div>

<p><img src="assets/ambari_repo.png" alt="ambari_repo" /></p>

<p><img src="assets/yum_repolist.png" alt="yum_repolist" /></p>

<p>Install ambari-server now using:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>yum install ambari-server
</code></pre>
</div>

<p><img src="assets/install_ambari_server.png" alt="install_ambari_server" /></p>

<p>Setup the ambari-server and follow the default configurations:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>ambari-server setup
</code></pre>
</div>

<p><img src="assets/ambari_server_setup.png" alt="ambari_server_setup" /></p>

<p>Start the ambari-server using:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>service ambari-server start
</code></pre>
</div>

<p><img src="assets/ambari_start_successfully.png" alt="ambari_start_successfully" /></p>

<h3 id="5-pseudo-mde-hdp-cluster-set-up-using-ambari-">5. Pseudo-Mde HDP Cluster Set up using Ambari <a id="pseudo-mode"></a></h3>

<p>Go to browser and type <code class="highlighter-rouge">127.0.0.1:8080</code> to access Ambari. The default username and password is <strong>admin</strong> and <strong>admin</strong> respectively.</p>

<p><img src="assets/sign_in.png" alt="sign_in" /></p>

<p>Go to Launch Install Wizard to start the installation</p>

<p><img src="assets/launch_cluster_wizard.png" alt="launch_cluster_wizard" /></p>

<p>Give a name to your cluster. It is really difficult to change the cluster name after it is set. Perhaps, pick a good name.</p>

<p><img src="assets/get_started.png" alt="get_started" /></p>

<p>Select the HDP version.</p>

<p><img src="assets/select_stack.png" alt="select_stack" /></p>

<p>Give the hostname of your machine . You can also put hostnames like host[1-100].domain.com to avoid typing each one. Then click on the <code class="highlighter-rouge">Choose file</code> button to provide the SSH key that was created earlier.</p>

<p><img src="assets/select_file.png" alt="select_file" /></p>

<p>Next, click on Register and Confirm.</p>

<p><img src="assets/upload_private_key.png" alt="upload_private_key" /></p>

<p>Confirm the list of hosts that needs to be added in the cluster.</p>

<p><img src="assets/confirm_hosts.png" alt="confirm_hosts" /></p>

<p>View the progress and wait for the Success message. Remove warnings for the smooth installation of the cluster.</p>

<p><img src="assets/confirm_hosts_success.png" alt="confirm_hosts_success" /></p>

<p>Choose the services that you want to install on your cluster.</p>

<p><img src="assets/choose_services.png" alt="choose_services" /></p>

<p>After checking the required boxes, click on Next</p>

<p><img src="assets/choose_services_next.png" alt="choose_services_next" /></p>

<p>Assign the hostname of all master components. As it is a pseudo-mode cluster, all master components will be installed on 1 machine.</p>

<p><img src="assets/assign_masters.png" alt="assign_masters" /></p>

<p><img src="assets/assign_masters_next.png" alt="assign_masters_next" /></p>

<p>Assign slave and client components.</p>

<p><img src="assets/assign_slaves.png" alt="assign_slaves" /></p>

<p>In <strong>Customize Services</strong> step, give the credentials for the service components that are marked with a white number against the red background.</p>

<p><img src="assets/customize_services.png" alt="customize_services" /></p>

<p>After entering the credentials, start the installation.</p>

<p><img src="assets/install_start_test.png" alt="install_start_test" /></p>

<p>You can view the progress of each component installation</p>

<p><img src="assets/start_progress.png" alt="start_progress" /></p>

<p>and the standard output of each component.</p>

<p><img src="assets/start_progress_logs.png" alt="start_progress_logs" /></p>

<p>Wait for some time for the installation. Once it gets completed, you will see the Ambari Dashboard:</p>

<p><img src="assets/ambari-dashboard.png" alt="ambari-dashboard" /></p>

<p>Voila!!! We have our very own Hadoop VM.
Happy Hadooping!</p>

</div>

<div id="tutorial-footer">
  <hr>
  <h2>Tutorial Q&amp;A and Reporting Issues</h2>
  <p>If you need help or have questions with this tutorial, please first check HCC for existing Answers to questions on this tutorial using the Find Answers button.  If you don't find your answer you can post a new HCC question for this tutorial using the Ask Questions button.</p>
  <p><a class="btn" href="https://community.hortonworks.com/topics/tutorial-/tutorials/hortonworks/hdp-2.5/introducing-apache-ambari-deploying-managing-hadoop/tutorial.html" role="button">Find Answers</a> <a class="btn pull-right" href="https://community.hortonworks.com/questions/ask.html?space=81&topics=tutorial-hdp-2.5.0&topics=hdp-2.5.0" role="button">Ask Questions</a></p>
  <p>Tutorial Name: <strong>Introducing Apache Ambari for Deploying and Managing Apache Hadoop</strong></p>
  <p>HCC Tutorial Tag:<strong> tutorial-/tutorials/hortonworks/hdp-2.5/introducing-apache-ambari-deploying-managing-hadoop/tutorial</strong> and <strong>hdp-2.5.0</strong></p>
  <p>If the tutorial has multiple labs please indicate which lab your question corresponds to. Please provide any feedback related to that lab.</p>
  <p>All Hortonworks, partner and community tutorials are posted in the Hortonworks github and can be contributed via the <a href="https://github.com/hortonworks/tutorials/wiki">Hortonworks Tutorial Contribution Guide</a>.  If you are certain there is an issue or bug with the tutorial, please <a href="https://github.com/hortonworks/tutorials/wiki#issues-with-tutorials">create an issue</a> on the repository and we will do our best to resolve it!</p>
</div>

