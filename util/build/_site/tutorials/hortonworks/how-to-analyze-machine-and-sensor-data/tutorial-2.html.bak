

<div class="tutorial-content">
  <h2 id="lab-2---analyze-data-with-excel-or-apache-zeppelin-a-namelab-2a">Lab 2 - Analyze Data with Excel or Apache Zeppelin <a name="lab-2"></a></h2>

<p>In this tutorial you can choose to report with</p>

<ul>
  <li><a href="#report-with-excel">Microsoft Excel</a></li>
  <li><a href="#report-with-zeppelin">Apache Zeppelin</a></li>
</ul>

<hr />

<h2 id="access-the-refined-sensor-data-with-microsoft-excel-a-namereport-with-excela">Access the Refined Sensor Data with Microsoft Excel <a name="report-with-excel"></a></h2>

<p>In this section, we will use Microsoft Excel Professional Plus 2013 to
access the refined sentiment data.</p>

<ul>
  <li>In Windows, open a new Excel workbook, then select <strong>Data &gt; From Other Sources &gt; From Microsoft Query</strong>.</li>
</ul>

<p><img src="/assets/analyzing-machine-and-sensor-data/18_open_query.jpg" alt="" /></p>

<ul>
  <li>On the Choose Data Source pop-up, select the Hortonworks ODBC data source you installed previously, then click <strong>OK</strong>.</li>
</ul>

<p>The Hortonworks ODBC driver enables you to access Hortonworks data with Excel and other Business Intelligence (BI) applications that support ODBC.</p>

<p><img src="/assets/analyzing-machine-and-sensor-data/19_choose_data_source.jpg" alt="" /></p>

<ul>
  <li>After the connection to the Sandbox is established, the Query Wizard appears. Select the “hvac_building” table in the Available tables and columns box, then click the right arrow button to add the entire “hvac_building” table to the query. Click <strong>Next</strong> to continue.</li>
</ul>

<p><img src="/assets/analyzing-machine-and-sensor-data/20_query_wizard1_choose_columns.jpg" alt="" /></p>

<ul>
  <li>On the Filter Data screen, click <strong>Next</strong> to continue without filtering the data.</li>
</ul>

<p><img src="/assets/analyzing-machine-and-sensor-data/21_query_wizard2_filter_data.jpg" alt="" /></p>

<ul>
  <li>On the Sort Order screen, click <strong>Next</strong> to continue without setting a sort order.</li>
</ul>

<p><img src="/assets/analyzing-machine-and-sensor-data/22_query_wizard3_sort_order.jpg" alt="" /></p>

<ul>
  <li>Click <strong>Finish</strong> on the Query Wizard Finish screen to retrieve the query data from the Sandbox and import it into Excel.</li>
</ul>

<p><img src="/assets/analyzing-machine-and-sensor-data/23_query_wizard4_finish.jpg" alt="" /></p>

<ul>
  <li>On the Import Data dialog box, click <strong>OK</strong> to accept the default settings and import the data as a table.</li>
</ul>

<p><img src="/assets/analyzing-machine-and-sensor-data/24_import_data.jpg" alt="" /></p>

<ul>
  <li>The imported query data appears in the Excel workbook.</li>
</ul>

<p><img src="/assets/analyzing-machine-and-sensor-data/25_data_imported.jpg" alt="" /></p>

<p>Now that we have successfully imported the refined sensor data into Microsoft Excel, we can use the Excel Power View feature to analyze and visualize the data.</p>

<h3 id="visualize-the-sensor-data-using-excel-power-view">Visualize the Sensor Data Using Excel Power View</h3>

<p>We will begin the data visualization by mapping the buildings that are most frequently outside of the optimal temperature range.</p>

<ul>
  <li>In the Excel worksheet with the imported “hvac_building” table, select <strong>Insert &gt; Power View</strong> to open a new Power View report.</li>
</ul>

<p><img src="/assets/analyzing-machine-and-sensor-data/26_open_powerview_hvac_building.jpg" alt="" /></p>

<ul>
  <li>The Power View Fields area appears on the right side of the window, with the data table displayed on the left. Drag the handles or click the Pop Out icon to maximize the size of the data table.</li>
</ul>

<p><img src="/assets/analyzing-machine-and-sensor-data/27_powerview_hvac_building.jpg" alt="" /></p>

<ul>
  <li>In the Power View Fields area, select the checkboxes next to the <strong>country</strong> and <strong>extremetemp</strong> fields, and clear all of the other checkboxes. You may need to scroll down to see all of the check boxes.</li>
</ul>

<p><img src="/assets/analyzing-machine-and-sensor-data/28_select_country_extremetemp.jpg" alt="" /></p>

<ul>
  <li>In the FIELDS box, click the down-arrow at the right of the <strong>extremetemp</strong> field, then select <strong>Count (Not Blank)</strong>.</li>
</ul>

<p><img src="/assets/analyzing-machine-and-sensor-data/29_extremetemp_count_not_blank.jpg" alt="" /></p>

<ul>
  <li>Click <strong>Map</strong> on the Design tab in the top menu.</li>
</ul>

<p><img src="/assets/analyzing-machine-and-sensor-data/30_open_map.jpg" alt="" /></p>

<ul>
  <li>The map view displays a global view of the data. We can see that the office in Finland had 814 sensor readings where the temperature was more than five degrees higher or lower than the target temperature. In contrast, the German office is doing a better job maintaining ideal office temperatures, with only 363 readings outside of the ideal range.</li>
</ul>

<p><img src="/assets/analyzing-machine-and-sensor-data/31_extremetemp_map.jpg" alt="" /></p>

<ul>
  <li>Hot offices can lead to employee complaints and reduced productivity. Let’s see which offices run hot.</li>
</ul>

<p>In the Power View Fields area, clear the <strong>extremetemp</strong> checkbox and select the <strong>temprange</strong> checkbox. Click the down-arrow at the right of the <strong>temprange</strong> field, then select <strong>Add as Size</strong>.</p>

<p><img src="/assets/analyzing-machine-and-sensor-data/32_add_temprange_as_size.jpg" alt="" /></p>

<ul>
  <li>Drag <strong>temprange</strong> from the Power View Fields area to the Filters box, then select the <strong>HOT</strong> checkbox. We can see that the buildings in Finland and France run hot most often.</li>
</ul>

<p><img src="/assets/analyzing-machine-and-sensor-data/33_filter_by_temprange_hot.jpg" alt="" /></p>

<ul>
  <li>Cold offices cause elevated energy expenditures and employee
discomfort.</li>
</ul>

<p>In the Filters box, clear the <strong>HOT</strong> checkbox and select the <strong>COLD</strong> checkbox. We can see that the buildings in Finland and Indonesia run cold most often.</p>

<p><img src="/assets/analyzing-machine-and-sensor-data/34_filter_by_temprange_cold.jpg" alt="" /></p>

<ul>
  <li>
    <p>Our data set includes information about the performance of five brands of HVAC equipment, distributed across many types of buildings in a wide variety of climates. We can use this data to assess the relative reliability of the different HVAC models.</p>
  </li>
  <li>
    <p>Open a new Excel worksheet, then select **Data &gt; From Other Sources</p>
  </li>
</ul>

<p>From <strong>Microsoft Query</strong> to access the hvac_building table. Follow the same procedure as before to import the data, but this time only select the “hvacproduct” and “extremetemp” columns.</p>

<p><img src="/assets/analyzing-machine-and-sensor-data/35_import_hvacproduct_extremetemp.jpg" alt="" /></p>

<ul>
  <li>In the Excel worksheet with the imported “hvacproduct” and “extremetemp” columns, select <strong>Insert &gt; Power View</strong> to open a new Power View report.</li>
</ul>

<p><img src="/assets/analyzing-machine-and-sensor-data/36_open_powerview_hvacproduct.jpg" alt="" /></p>

<ul>
  <li>Click the Pop Out icon to maximize the size of the data table. In the FIELDS box, click the down-arrow at the right of the extremetemp field, then select Count (Not Blank).</li>
</ul>

<p><img src="/assets/analyzing-machine-and-sensor-data/37_extremetemp_count_not_blank.jpg" alt="" /></p>

<ul>
  <li>Select <strong>Column Chart &gt; Stacked Column</strong>in the top menu.</li>
</ul>

<p><img src="/assets/analyzing-machine-and-sensor-data/38_open_stacked_column.jpg" alt="" /></p>

<ul>
  <li>Click the down-arrow next to <strong>sort by hvacproduct</strong> in the upper left corner of the chart area, then select <strong>Count of extremetemp</strong>.</li>
</ul>

<p><img src="/assets/analyzing-machine-and-sensor-data/39_sort_by_extremetemp.jpg" alt="" /></p>

<ul>
  <li>We can see that the GG1919 model seems to regulate temperature most reliably, whereas the FN39TG failed to maintain the appropriate temperature range 9% more frequently than the GG1919.</li>
</ul>

<p><img src="/assets/analyzing-machine-and-sensor-data/40_chart_sorted_by_extremetemp.jpg" alt="" /></p>

<p>We’ve shown how the Hortonworks Data Platform (HDP) can store and analyze sensor data. With real-time access to massive amounts of temperature and other types of data on HDP, your facilities department can initiate data-driven strategies to reduce energy expenditures and improve employee comfort.</p>

<hr />

<h2 id="access-the-refined-sensor-data-with-apache-zeppelin-a-namereport-with-zeppelina">Access the Refined Sensor Data with Apache Zeppelin <a name="report-with-zeppelin"></a></h2>

<p>Apache Zeppelin makes data reporting easy on Hadoop. It has direct connections to Apache Spark and Hive in your cluster and allows you to create visualizations and analyze your data on the fly.</p>

<p>To start you’re going to need to open up the <a href="http://localhost:8080/#/main/views/ZEPPELIN/1.0.0/INSTANCE_1">Apache Zeppelin view</a> in Ambari.</p>

<p>Start by navigating back to the <a href="http://localhost:8080">Ambari Dashboard</a> at <code class="highlighter-rouge">http://localhost:8080</code></p>

<ul>
  <li>Use the dropdown menu to open the Zeppelin View.</li>
</ul>

<p><img src="/assets/analyzing-machine-and-sensor-data/41_ambari_zeppelin_view.png" alt="" /></p>

<ul>
  <li>From here we’re going to need to create a new Zeppelin Notebook.</li>
  <li>Notebooks in Zeppelin is how we differentiate reports from one another.</li>
  <li>Hove over <strong>Notebook</strong>. Use the dropdown menu and <strong>Create a new note</strong>.</li>
</ul>

<p><img src="/assets/analyzing-machine-and-sensor-data/42_create_zeppelin_note.png" alt="" /></p>

<ul>
  <li>Name the note <strong>HVAC Analysis Report</strong> and then <strong>Create Note</strong>.</li>
</ul>

<p><img src="/assets/analyzing-machine-and-sensor-data/43_zeppelin_naming_note.png" alt="" /></p>

<ul>
  <li>Head back to the Zeppelin homepage.</li>
  <li>Use the <strong>Notebook</strong> dropdown menu to open the new notebook <strong>HVAC Analysis Report</strong>.</li>
</ul>

<p><img src="/assets/analyzing-machine-and-sensor-data/43_1_opening_note.png" alt="" /></p>

<ul>
  <li>Zeppelin integrates with Hadoop by using things called <em>interpreters</em>.</li>
  <li>In this tutorial we’ll be working with the Hive interpreter to run Hive queries in Zeppelin, then visualize the results from our Hive queries directly in Zeppelin.</li>
  <li>To specify the Hive interpreter for this note, we need to put <code class="highlighter-rouge">%hive</code> at the top of the note. Everything afterwards will be interpreted as a Hive query.</li>
</ul>

<p><img src="/assets/analyzing-machine-and-sensor-data/44_blank_zeppelin_notebook.png" alt="" /></p>

<ul>
  <li>Type the following query into the note, then run it by clicking the <strong>Run</strong> arrow or by using the shortcut <strong>Shift+Enter</strong>.</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>%hive

select country, extremetemp, temprange from hvac_building
</code></pre>
</div>

<p><img src="/assets/analyzing-machine-and-sensor-data/45_zeppelin_query.png" alt="" /></p>

<ul>
  <li>After running the previous query we can view a chart of the data by clicking the chart button located just under the query.</li>
</ul>

<p><img src="/assets/analyzing-machine-and-sensor-data/46_table_to_chart.png" alt="" /></p>

<ul>
  <li>Click <strong>settings</strong> to open up more advanced settings for creating the chart. Here you can experiment with different values and columns to create different types of charts.</li>
</ul>

<p><img src="/assets/analyzing-machine-and-sensor-data/47_changing_chart_settings.png" alt="" /></p>

<ul>
  <li>Arrange the fields according to the following image.</li>
  <li>Drag the field <code class="highlighter-rouge">temprange</code> into the <strong>groups</strong> box.</li>
  <li>Click <strong>SUM</strong> on <code class="highlighter-rouge">extremetemp</code> and change it to <strong>COUNT</strong>.</li>
  <li>Make sure that <code class="highlighter-rouge">country</code> is the only field under <strong>Keys</strong>.</li>
</ul>

<p><img src="/assets/analyzing-machine-and-sensor-data/48_chart_setup.png" alt="" /></p>

<p>Awesome! You’ve just created your first chart using Apache Zeppelin.</p>

<ul>
  <li>From this chart we can see which countries have the most extreme temperature and how many <strong>NORMAL</strong> events there are compared to <strong>HOT</strong> and <strong>COLD</strong>.</li>
  <li>It could be possible to figure out which buildings might need HVAC upgrades, and which do not.</li>
</ul>

<p><img src="/assets/analyzing-machine-and-sensor-data/49_chart_finished.png" alt="" /></p>

<ul>
  <li>Let’s try creating one more note to visualize which types of HVAC systems result in the least amount of <code class="highlighter-rouge">extremetemp</code> readings.</li>
  <li>Paste the following query into the blank Zeppelin note following the chart we made previously.</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>%hive

select hvacproduct, extremetemp from hvac_building
</code></pre>
</div>

<ul>
  <li>Now use <strong>Shift+Enter</strong> to run the note.</li>
</ul>

<p><img src="/assets/analyzing-machine-and-sensor-data/50_second_query.png" alt="" /></p>

<ul>
  <li>Arrange the fields according to the following image so we can recreate the chart below.</li>
  <li>Make sure that <code class="highlighter-rouge">hvacproduct</code> is in the <strong>Keys</strong> box.</li>
  <li>Make sure that <code class="highlighter-rouge">extremetemp</code> is in the <strong>Values</strong> box and that it is set to <strong>COUNT</strong>.</li>
</ul>

<p><img src="/assets/analyzing-machine-and-sensor-data/51_chart_two.png" alt="" /></p>

<ul>
  <li>Now we can see which HVAC units result in the most <code class="highlighter-rouge">extremetemp</code> readings. Thus we can make a more informed decision when purchasing new HVAC systems.</li>
</ul>

<p>Apache Zeppelin gives you the power to connect right to your Hadoop cluster to quickly obtain results from the data inside of Hadoop without having to export data to any other sources.</p>

<p>It’s also important to note that Zeppelin contains many, many interpreters that can be utilized to obtain data in a variety of ways.</p>

<p>One of the default interpreters included with Zeppelin is for Apache Spark. With the popularity of Apache Spark rising, you can simply write Spark scripts to execute directly on Apache Zeppelin to obtain results from your data in a matter of seconds.</p>

<h3 id="feedback">Feedback</h3>

<p>We are eager to hear your feedback on this tutorial. Please let us know
what you think.</p>

<p><a href="https://www.surveymonkey.com/s/Sandbox_Machine_Sensor">Click here to take survey</a></p>

</div>

<div id="tutorial-footer">
  <hr>
  <h2>Tutorial Q&amp;A and Reporting Issues</h2>
  <p>If you need help or have questions with this tutorial, please first check HCC for existing Answers to questions on this tutorial using the Find Answers button.  If you don't find your answer you can post a new HCC question for this tutorial using the Ask Questions button.</p>
  <p><a class="btn" href="https://community.hortonworks.com/topics/tutorial-310.html" role="button">Find Answers</a> <a class="btn pull-right" href="https://community.hortonworks.com/questions/ask.html?space=81&topics=tutorial-310&topics=hdp-2.4.0" role="button">Ask Questions</a></p>
  <p>Tutorial Name: <strong>How to Analyze Machine and Sensor Data</strong></p>
  <p>HCC Tutorial Tag:<strong> tutorial-310</strong> and <strong>hdp-2.4.0</strong></p>
  <p>If the tutorial has multiple labs please indicate which lab your question corresponds to. Please provide any feedback related to that lab.</p>
  <p>All Hortonworks, partner and community tutorials are posted in the Hortonworks github and can be contributed via the <a href="https://github.com/hortonworks/tutorials/wiki">Hortonworks Tutorial Contribution Guide</a>.  If you are certain there is an issue or bug with the tutorial, please <a href="https://github.com/hortonworks/tutorials/wiki#issues-with-tutorials">create an issue</a> on the repository and we will do our best to resolve it!</p>
</div>
